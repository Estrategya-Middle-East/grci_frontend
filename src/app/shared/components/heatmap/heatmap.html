<div class="heatmap-container">
  @if (impactColumns().length && likelihoodRows().length) {
  <div class="heatmap-wrapper">
    <!-- X-axis labels (Impact) -->
    <div class="heatmap-x-labels">
      <div class="empty-corner"></div>
      @for (col of impactColumns(); track col.id) {
      <div class="x-label">{{ col.title }}</div>
      }
    </div>

    <!-- Heatmap grid with Y-axis labels (Likelihood) -->
    <div class="heatmap-body">
      @for (row of likelihoodRows(); track row.id) {
      <!-- Y-axis label -->
      <div class="y-label">{{ row.title }}</div>

      <!-- Row of heatmap cells -->
      <div
        class="heatmap-row"
        [style.gridTemplateColumns]="
          'repeat(' + impactColumns().length + ', 1fr)'
        "
      >
        @for (col of impactColumns(); track col.id) {
        <div
          class="heatmap-cell"
          [style.background]="getCellColor(col.id, row.id)"
        >
          <div class="cell-score">
            {{ getCellLabel(col.id, row.id) }}
          </div>
          @if (loadWithRisks && getCellRisks(col.id, row.id).length) {
          <div class="cell-risks" title="{{ getRiskTooltip(col.id, row.id) }}">
            @for (risk of getCellRisks(col.id, row.id); track risk.riskId) {
            <div class="risk-item p-2 bg-body-secondary rounded-5 text-black">
              {{ risk.riskCode }}
            </div>
            }
          </div>
          }
        </div>
        }
      </div>
      }
    </div>
  </div>
  } @else {
  <div class="text-muted text-center p-3">Loading heatmap...</div>
  }
</div>
